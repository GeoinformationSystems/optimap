{% extends "main.html" %}

{% block title %}Locate Publications | {% endblock %}

{% block head %}
{{ block.super }}
<style>
  .locate-container {
    max-width: 100%;
    overflow-wrap: break-word;
    word-wrap: break-word;
    word-break: break-word;
    hyphens: auto;
  }
  .locate-container p, .locate-container div, .locate-container span {
    max-width: 100%;
    overflow-wrap: break-word;
    word-wrap: break-word;
  }
</style>
{% endblock %}

{% block content %}

<div class="container-fluid locate-container">
  <div class="row justify-content-center">
    <div class="col-md-10 col-lg-8 py-5">
    <h1 class="py-2">Locate Publications</h1>

    <p class="lead">Help us locate scientific publications on the map!</p>

    <p class="text-wrap text-break">The publications listed below have been harvested from various scientific sources but do not have geolocation data yet. If you know the geographic location or area mentioned in any of these publications, you can help us improve our database.</p>

    {% if total_count > 0 %}
      <div class="alert alert-info text-break" role="alert">
        <i class="fas fa-info-circle"></i>
        <strong>{{ total_count }}</strong> publication{{ total_count|pluralize }} need{{ total_count|pluralize:"s," }} geolocation data.
      </div>

      <div class="row">
        {% for publication in publications %}
        <div class="col-md-6 mb-4">
          <div class="card h-100">
            <div class="card-body">
              <h5 class="card-title text-break">
                {% if publication.doi %}
                  <a href="https://doi.org/{{ publication.doi }}" target="_blank" class="text-decoration-none">
                    {{ publication.title|truncatechars:100 }}
                    <i class="fas fa-external-link-alt fa-sm"></i>
                  </a>
                {% else %}
                  {{ publication.title|truncatechars:100 }}
                {% endif %}
              </h5>

              {% if publication.abstract %}
                <p class="card-text text-muted text-break">
                  {{ publication.abstract|truncatechars:200 }}
                </p>
              {% endif %}

              <div class="card-footer bg-transparent">
                <small class="text-muted text-break">
                  {% if publication.publicationDate %}
                    Published: {{ publication.publicationDate|date:"M d, Y" }}
                  {% endif %}
                  {% if publication.source %}
                    <br>Source: {{ publication.source.name }}
                  {% endif %}
                  {% if publication.doi %}
                    <br>DOI: <span class="text-break">{{ publication.doi }}</span>
                  {% endif %}
                </small>
              </div>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>

      {% if publications|length >= 20 %}
        <div class="alert alert-secondary mt-4" role="alert">
          <i class="fas fa-info-circle"></i>
          Showing first 20 publications. More publications without geolocation data are available.
        </div>
      {% endif %}

    {% else %}
      <div class="alert alert-success" role="alert">
        <i class="fas fa-check-circle"></i>
        Great! All harvested publications currently have geolocation data.
      </div>
    {% endif %}

    <div class="mt-5">
      <h3>How to help</h3>
      <p>If you recognize any publications that reference specific geographic locations, please contact us with the following information:</p>
      <ul>
        <li>Publication DOI or title</li>
        <li>Geographic coordinates (latitude/longitude) or place names</li>
        <li>Brief description of the geographic relevance</li>
      </ul>
      <p>
        <a href="/about" class="btn btn-primary">
          <i class="fas fa-envelope"></i> Contact Us
        </a>
        <a href="/" class="btn btn-outline-secondary">
          <i class="fas fa-map"></i> Back to Map
        </a>
      </p>
    </div>
  </div>
</div>

{% endblock content %}